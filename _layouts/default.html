{%- include global_variables.html -%}
{%- assign theme = site.posts | find: 'layout', 'theme' -%}
<!DOCTYPE html>
<html lang="{{ site.lang }}" dir="{{ site.dir }}">
  <head>
    <meta charset="UTF-8">
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta name="theme-color" content="white"/>
    <meta name="color-scheme" content="light"/>
    <meta name="referrer" content="strict-origin-when-cross-origin"/>

    {% if page.layout == 'work_cited' %}
      {%- assign url = page.book.works_cited.url | absolute_url | append: '#' | append: page.slug -%}
      <meta http-equiv="refresh" content="0;url={{ url }}" />
    {% endif %}

    {% comment %}
      Bust cache when we build the site.
    {% endcomment %}
    <link href="/assets/css/styles.css?{{ site.time | date: '%s' }}" rel="stylesheet">

    <script type="text/javascript" src="/assets/js/env.js?{{ site.time | date: '%s' }}"></script>
    <script defer src="/assets/js/pack.js?{{ site.time | date: '%s' }}"></script>

    {% comment %}
      Preload fonts
    {% endcomment %}
    {% include_cached preload_font.html font='assets/fonts/forkawesome-webfont.woff2' %}
    {% include_cached preload_font.html font='assets/fonts/opensans/v20/mem5YaGs126MiZpBA-UN7rgOUuhs-subset.woff2' %}
    {% include_cached preload_font.html font='assets/fonts/opensans/v20/mem5YaGs126MiZpBA-UN_r8OUuhs-subset.woff2' %}

    {% for apple_touch_size in site.data.favicon_sizes.apple_touch_sizes %}
      <link rel="apple-touch-icon" sizes="{{ apple_touch_size }}x{{ apple_touch_size }}" href="{{ theme.favicon.path | thumbnail: apple_touch_size, apple_touch_size | uri_escape }}">
    {% endfor %}

    {% for chrome_icon_size in site.data.favicon_sizes.chrome_icon_sizes %}
      <link rel="icon" type="image/png" sizes="{{ chrome_icon_size }}x{{chrome_icon_size }}" href="{{ theme.favicon.path | thumbnail: chrome_icon_size , chrome_icon_size | uri_escape }}">
    {% endfor %}

    {% for msapplication_size in site.data.favicon_sizes.msapplication_sizes %}
      <meta name="msapplication-TileImage" content="{{ theme.favicon.path | thumbnail: msapplication_size , msapplication_size | uri_escape }}">
    {% endfor %}

    {% if jekyll.environment == 'production' %}
      {% seo %}
      {% include_cached google-codes.html %}
    {% endif %}
  </head>
  <body class="d-flex d-print-block flex-column justify-content-between align-items-center min-h-100vh">
    <a class="sr-only sr-only-focusable" href="#content">{{ t.skip_to_content }}</a>

    {%- include_cached navbar.html cache_key=current_book -%}

    <main class="flex-grow-1 w-100{% if site.book_layouts contains page.layout or page.layout == 'home' %} background-black background{% endif %}">
      {{ content }}
    </main>

    {%- include_cached footer.html cache_key=current_book -%}

    <div data-turbo-permanent>
      {% include_cached device_detector.html %}
    </div>
  </body>
</html>
